


ARM Macro Assembler    Page 1 


    1 00000000         ;******************** (C) COPYRIGHT 2018 IoTality ******
                       **************
    2 00000000         ;* File Name          : LED.s
    3 00000000         ;* Author             : Gopal
    4 00000000         ;* Date               : 07-Feb-2018
    5 00000000         ;* Description        : A simple code to blink LEDs on S
                       TM32F4 discovery board
    6 00000000         ;*                      - The functions are called from 
                       startup code
    7 00000000         ;*                      - Initialization carried out for
                        GPIO-D pins PD12 to PD15 (connected to LEDs)
    8 00000000         ;*                      - Blink interval delay implement
                       ed in software
    9 00000000         ;*******************************************************
                       ************************
   10 00000000                 GET              reg_stm32f407xx.inc
    1 00000000         
    2 00000000         ; ******* Register definitions *******
    3 00000000         
    4 00000000         ;As per STM32F407 datasheet and reference manual
    5 00000000         
    6 00000000 40023830 
                       RCC_AHB1ENR
                               EQU              0x40023830  ;Clock control for 
                                                            AHB1 peripherals (i
                                                            ncludes GPIO)
    7 00000000         
    8 00000000         ;GPIO-D control registers
    9 00000000 40020C00 
                       GPIOD_MODER
                               EQU              0x40020C00  ;set GPIO pin mode 
                                                            as Input/Output/Ana
                                                            log
   10 00000000 40020C04 
                       GPIOD_OTYPER
                               EQU              0x40020C04  ;Set GPIO pin type 
                                                            as push-pull or ope
                                                            n drain
   11 00000000 40020C08 
                       GPIOD_OSPEEDR
                               EQU              0x40020C08  ;Set GPIO pin switc
                                                            hing speed
   12 00000000 40020C0C 
                       GPIOD_PUPDR
                               EQU              0x40020C0C  ;Set GPIO pin pull-
                                                            up/pull-down
   13 00000000 40020C14 
                       GPIOD_ODR
                               EQU              0x40020C14  ;GPIO pin output da
                                                            ta
   14 00000000         
   15 00000000 40020C18 
                       GPIOD_BSRR
                               EQU              0x40020C18
   16 00000000         
   17 00000000 E000E010 
                       SYSTICK_CONTROLR
                               EQU              0xE000E010
   18 00000000 E000E014 



ARM Macro Assembler    Page 2 


                       SYSTICK_RELOADR
                               EQU              0xE000E014
   19 00000000         
   20 00000000         
   21 00000000         ; **************************
   22 00000000         
   23 00000000         
   24 00000000                 END
   11 00000000         
   12 00000000                 AREA             ISRCODE, CODE, READONLY
   13 00000000         
   14 00000000         SysTick_Handler
                               PROC                         ; Aqui definimos lo
                                                             que se ejecuta en 
                                                            la excepcion
   15 00000000                 EXPORT           SysTick_Handler
   16 00000000         
   17 00000000         ; Codigo aqui
   18 00000000         
   19 00000000         ; Sumando 1s a los registros que llevan el tiempo, el de
                       l semaforo amarillo no 
   20 00000000         ; se toma en cuenta.
   21 00000000 F102 0201       ADD              R2, R2, #1  ; Contador de tiemp
                                                            o de los carros
   22 00000004 F104 0401       ADD              R4, R4, #1  ; tiempo de espera 
                                                            del carril contrari
                                                            o
   23 00000008         
   24 00000008         ; Comparaciones y saltos
   25 00000008 F1BD 0F01       CMP              R13, #1     ; Estado 1?
   26 0000000C D009            BEQ              E1
   27 0000000E F1BD 0F02       CMP              R13, #2     ; Estado 2?
   28 00000012 D006            BEQ              E2
   29 00000014 F1BD 0F03       CMP              R13, #3     ; Estado 3?
   30 00000018 D003            BEQ              E3
   31 0000001A F1BD 0F04       CMP              R13, #4     ; Estado 4?
   32 0000001E D000            BEQ              E4
   33 00000020         ; Default
   34 00000020 D0FF            BEQ              Done
   35 00000022         
   36 00000022         E1                                   ; Estado 1
   37 00000022         
   38 00000022         E2                                   ; Estado 2
   39 00000022         
   40 00000022         E3                                   ; Estado 3
   41 00000022         
   42 00000022         E4                                   ; Estado 4
   43 00000022         
   44 00000022         Done                                 ; Branch de finaliz
                                                            acion
   45 00000022         
   46 00000022 4770            BX               LR          ; Necesario al ser 
                                                            una excepcion.
   47 00000024         
   48 00000024                 ENDP
   49 00000024         
   50 00000024                 ALIGN            4
   51 00000024 0000F000 
                       LEDs_ON EQU              0x0000F000



ARM Macro Assembler    Page 3 


   52 00000024 F0000000 
                       LEDs_OFF
                               EQU              0xF0000000
   53 00000024         
   54 00000024         
   55 00000024                 END
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4.fp.sp --apcs=
interwork --depend=.\objects\isr.d -o.\objects\isr.o -IC:\Users\kev_s\AppData\L
ocal\Arm\Packs\Keil\STM32F4xx_DFP\2.15.0\Drivers\CMSIS\Device\ST\STM32F4xx\Incl
ude -IC:\Keil_v5\ARM\CMSIS\Include --predefine="__EVAL SETA 1" --predefine="__U
VISION_VERSION SETA 531" --predefine="STM32F407xx SETA 1" --list=.\listings\isr
.lst ..\src\isr.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

Done 00000022

Symbol: Done
   Definitions
      At line 44 in file ..\src\isr.s
   Uses
      At line 34 in file ..\src\isr.s
Comment: Done used once
E1 00000022

Symbol: E1
   Definitions
      At line 36 in file ..\src\isr.s
   Uses
      At line 26 in file ..\src\isr.s
Comment: E1 used once
E2 00000022

Symbol: E2
   Definitions
      At line 38 in file ..\src\isr.s
   Uses
      At line 28 in file ..\src\isr.s
Comment: E2 used once
E3 00000022

Symbol: E3
   Definitions
      At line 40 in file ..\src\isr.s
   Uses
      At line 30 in file ..\src\isr.s
Comment: E3 used once
E4 00000022

Symbol: E4
   Definitions
      At line 42 in file ..\src\isr.s
   Uses
      At line 32 in file ..\src\isr.s
Comment: E4 used once
ISRCODE 00000000

Symbol: ISRCODE
   Definitions
      At line 12 in file ..\src\isr.s
   Uses
      None
Comment: ISRCODE unused
SysTick_Handler 00000000

Symbol: SysTick_Handler
   Definitions
      At line 14 in file ..\src\isr.s
   Uses
      At line 15 in file ..\src\isr.s
Comment: SysTick_Handler used once
7 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

GPIOD_BSRR 40020C18

Symbol: GPIOD_BSRR
   Definitions
      At line 15 in file ..\src\reg_stm32f407xx.inc
   Uses
      None
Comment: GPIOD_BSRR unused
GPIOD_MODER 40020C00

Symbol: GPIOD_MODER
   Definitions
      At line 9 in file ..\src\reg_stm32f407xx.inc
   Uses
      None
Comment: GPIOD_MODER unused
GPIOD_ODR 40020C14

Symbol: GPIOD_ODR
   Definitions
      At line 13 in file ..\src\reg_stm32f407xx.inc
   Uses
      None
Comment: GPIOD_ODR unused
GPIOD_OSPEEDR 40020C08

Symbol: GPIOD_OSPEEDR
   Definitions
      At line 11 in file ..\src\reg_stm32f407xx.inc
   Uses
      None
Comment: GPIOD_OSPEEDR unused
GPIOD_OTYPER 40020C04

Symbol: GPIOD_OTYPER
   Definitions
      At line 10 in file ..\src\reg_stm32f407xx.inc
   Uses
      None
Comment: GPIOD_OTYPER unused
GPIOD_PUPDR 40020C0C

Symbol: GPIOD_PUPDR
   Definitions
      At line 12 in file ..\src\reg_stm32f407xx.inc
   Uses
      None
Comment: GPIOD_PUPDR unused
LEDs_OFF F0000000

Symbol: LEDs_OFF
   Definitions
      At line 52 in file ..\src\isr.s
   Uses
      None
Comment: LEDs_OFF unused
LEDs_ON 0000F000

Symbol: LEDs_ON



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 51 in file ..\src\isr.s
   Uses
      None
Comment: LEDs_ON unused
RCC_AHB1ENR 40023830

Symbol: RCC_AHB1ENR
   Definitions
      At line 6 in file ..\src\reg_stm32f407xx.inc
   Uses
      None
Comment: RCC_AHB1ENR unused
SYSTICK_CONTROLR E000E010

Symbol: SYSTICK_CONTROLR
   Definitions
      At line 17 in file ..\src\reg_stm32f407xx.inc
   Uses
      None
Comment: SYSTICK_CONTROLR unused
SYSTICK_RELOADR E000E014

Symbol: SYSTICK_RELOADR
   Definitions
      At line 18 in file ..\src\reg_stm32f407xx.inc
   Uses
      None
Comment: SYSTICK_RELOADR unused
11 symbols
352 symbols in table
